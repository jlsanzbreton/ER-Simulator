"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[91],{1091:function(e,n,t){t.r(n),t.d(n,{default:function(){return L}});var r,l=t(5893),o=t(7294);function i(e,n){return Object.freeze({...e,...n})}let a=(0,o.createContext)(null),u=a.Provider;function c(){let e=(0,o.useContext)(a);if(null==e)throw Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}var s=t(5243),f=t.n(s);function d(){return(d=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}let p=(0,o.forwardRef)(function({bounds:e,boundsOptions:n,center:t,children:r,className:l,id:i,placeholder:a,style:c,whenReady:f,zoom:p,...g},m){let[h]=(0,o.useState)({className:l,id:i,style:c}),[v,y]=(0,o.useState)(null);(0,o.useImperativeHandle)(m,()=>v?.map??null,[v]);let O=(0,o.useCallback)(r=>{if(null!==r&&null===v){let l=new s.Map(r,g);null!=t&&null!=p?l.setView(t,p):null!=e&&l.fitBounds(e,n),null!=f&&l.whenReady(f),y(Object.freeze({__version:1,map:l}))}},[]);(0,o.useEffect)(()=>()=>{v?.map.remove()},[v]);let b=v?o.createElement(u,{value:v},r):a??null;return o.createElement("div",d({},h,{ref:O}),b)});function g(e){return(0,o.forwardRef)(function(n,t){let{instance:r,context:l}=e(n).current;return(0,o.useImperativeHandle)(t,()=>r),null==n.children?null:o.createElement(u,{value:l},n.children)})}function m(e,n,t){return Object.freeze({instance:e,context:n,container:t})}function h(e,n){return null==n?function(n,t){let r=(0,o.useRef)();return r.current||(r.current=e(n,t)),r}:function(t,r){let l=(0,o.useRef)();l.current||(l.current=e(t,r));let i=(0,o.useRef)(t),{instance:a}=l.current;return(0,o.useEffect)(function(){i.current!==t&&(n(a,t,i.current),i.current=t)},[a,t,r]),l}}function v(e,n){let t=(0,o.useRef)();(0,o.useEffect)(function(){return null!=n&&e.instance.on(n),t.current=n,function(){null!=t.current&&e.instance.off(t.current),t.current=null}},[e,n])}function y(e,n){let t=e.pane??n.pane;return t?{...e,pane:t}:e}function O(e,n){(0,o.useEffect)(function(){return(n.layerContainer??n.map).addLayer(e.instance),function(){n.layerContainer?.removeLayer(e.instance),n.map.removeLayer(e.instance)}},[n,e])}function b(e){return function(n){let t=c(),r=e(y(n,t),t);return!function(e,n){let t=(0,o.useRef)(n);(0,o.useEffect)(function(){n!==t.current&&null!=e.attributionControl&&(null!=t.current&&e.attributionControl.removeAttribution(t.current),null!=n&&e.attributionControl.addAttribution(n)),t.current=n},[e,n])}(t.map,n.attribution),v(r.current,n.eventHandlers),O(r.current,t),r}}function x(e,n){var t;return g((t=h(e,n),function(e){let n=c(),r=t(y(e,n),n);return v(r.current,e.eventHandlers),O(r.current,n),function(e,n){let t=(0,o.useRef)();(0,o.useEffect)(function(){if(n.pathOptions!==t.current){let r=n.pathOptions??{};e.instance.setStyle(r),t.current=r}},[e,n])}(r.current,e),r}))}t(3935);let C=(r=b(h(function({url:e,...n},t){return m(new s.TileLayer(e,y(n,t)),t)},function(e,n,t){!function(e,n,t){let{opacity:r,zIndex:l}=n;null!=r&&r!==t.opacity&&e.setOpacity(r),null!=l&&l!==t.zIndex&&e.setZIndex(l)}(e,n,t);let{url:r}=n;null!=r&&r!==t.url&&e.setUrl(r)})),(0,o.forwardRef)(function(e,n){let{instance:t}=r(e).current;return(0,o.useImperativeHandle)(n,()=>t),null})),w=x(function({positions:e,...n},t){let r=new s.Polyline(e,n);return m(r,i(t,{overlayContainer:r}))},function(e,n,t){n.positions!==t.positions&&e.setLatLngs(n.positions)}),E=x(function({center:e,children:n,...t},r){let l=new s.Circle(e,t);return m(l,i(r,{overlayContainer:l}))},function(e,n,t){n.center!==t.center&&e.setLatLng(n.center),null!=n.radius&&n.radius!==t.radius&&e.setRadius(n.radius)}),j=g(b(h(function({position:e,...n},t){let r=new s.Marker(e,n);return m(r,i(t,{overlayContainer:r}))},function(e,n,t){n.position!==t.position&&e.setLatLng(n.position),null!=n.icon&&n.icon!==t.icon&&e.setIcon(n.icon),null!=n.zIndexOffset&&n.zIndexOffset!==t.zIndexOffset&&e.setZIndexOffset(n.zIndexOffset),null!=n.opacity&&n.opacity!==t.opacity&&e.setOpacity(n.opacity),null!=e.dragging&&n.draggable!==t.draggable&&(!0===n.draggable?e.dragging.enable():e.dragging.disable())}))),z=f().icon({iconUrl:"/leaflet/marker-icon.png",iconRetinaUrl:"/leaflet/marker-icon-2x.png",shadowUrl:"/leaflet/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),S={N:[.001,0],NE:[7e-4,7e-4],E:[0,.001],SE:[-.0007,7e-4],S:[-.001,0],SO:[-.0007,-.0007],O:[0,-.001],NO:[7e-4,-.0007]};var L=e=>{let{coords:n,condiciones:t,fase:r}=e,[i,a]=(0,o.useState)(n),[u,s]=(0,o.useState)(350),[f,d]=(0,o.useState)(null),[g,m]=(0,o.useState)([]);(0,o.useEffect)(()=>{fetch("/geojson/andalucia-v2.geojson").then(e=>{if(!e.ok)throw Error("GeoJSON fetch failed");return e.json()}).then(e=>d(e)).catch(e=>{console.error("Error loading GeoJSON:",e)})},[]),(0,o.useEffect)(()=>{if(!t)return;let[e,n]=S[t.viento.direccion]||[0,0];a(r=>{let l={lat:r.lat+e*t.viento.fuerza*.1,lng:r.lng+n*t.viento.fuerza*.1};return m(e=>[...e,l]),l}),s(e=>e+50)},[r,t]),(0,o.useEffect)(()=>{let e;let n=0,t=g.length>0?g[g.length-1]:i;if(i.lat!==t.lat||i.lng!==t.lng){let r=()=>{let l=++n/20;a({lat:i.lat+(t.lat-i.lat)*l,lng:i.lng+(t.lng-i.lng)*l}),n<20&&(e=requestAnimationFrame(r))};r()}return()=>cancelAnimationFrame(e)},[g,i]);let h=f?function(e){let n=e.features.find(e=>{var n,t;return"LineString"===e.geometry.type&&((null===(n=e.properties)||void 0===n?void 0:n.layer)==="costa"||(null===(t=e.properties)||void 0===t?void 0:t.layer)==="coastline")});return n?n.geometry.coordinates.map(e=>[e[0],e[1]]):null}(f):null;return(0,l.jsx)("div",{className:"card card-max card-centered map-card-outer mb-2",children:(0,l.jsxs)(p,{center:[i.lat,i.lng],zoom:14,className:"sim-map-container",scrollWheelZoom:!1,dragging:!1,doubleClickZoom:!1,zoomControl:!1,attributionControl:!1,children:[(0,l.jsx)(function(e){let{center:n,radio:t}=e,r=c().map;return(0,o.useEffect)(()=>{let e=12.5;t>1200&&(e=11.5),t>2500&&(e=10.5),t>4e3&&(e=9.5),t>6e3&&(e=8.5),t>8e3&&(e=7.5),t>1e4&&(e=6.5),t>12e3&&(e=5.5),r.setView(n,e,{animate:!0})},[n,t,r]),null},{center:[i.lat,i.lng],radio:u}),(0,l.jsx)(C,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),h&&h.length>1&&(0,l.jsx)(w,{positions:h.map(e=>{let[n,t]=e;return[t,n]}),pathOptions:{color:"#e53935",weight:2,opacity:.5}}),(0,l.jsx)(E,{center:[i.lat,i.lng],radius:1.7*u,pathOptions:{color:void 0,fillColor:"#0277bd",fillOpacity:.07},className:"mancha-glow"}),(0,l.jsx)(E,{center:[i.lat,i.lng],radius:1.4*u,pathOptions:{color:void 0,fillColor:"#0277bd",fillOpacity:.13}}),(0,l.jsx)(E,{center:[i.lat,i.lng],radius:1.15*u,pathOptions:{color:void 0,fillColor:"#0277bd",fillOpacity:.18}}),(0,l.jsx)(E,{center:[i.lat,i.lng],radius:u,pathOptions:{color:"#0277bd",fillColor:"#0277bd",fillOpacity:.35}}),g.slice(-5,-1).map((e,n)=>(0,l.jsx)(E,{center:[e.lat,e.lng],radius:.7*u,pathOptions:{color:void 0,fillColor:"#81d4fa",fillOpacity:.1}},n)),z&&(0,l.jsx)(j,{position:n,icon:z})]})})}}}]);