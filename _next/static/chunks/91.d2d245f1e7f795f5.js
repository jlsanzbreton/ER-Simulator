"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[91],{1091:function(e,t,n){n.r(t),n.d(t,{default:function(){return L}});var r,l=n(5893),o=n(7294);function a(e,t){return Object.freeze({...e,...t})}let i=(0,o.createContext)(null),u=i.Provider;function c(){let e=(0,o.useContext)(i);if(null==e)throw Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}var s=n(5243),f=n.n(s);function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}let p=(0,o.forwardRef)(function({bounds:e,boundsOptions:t,center:n,children:r,className:l,id:a,placeholder:i,style:c,whenReady:f,zoom:p,...g},m){let[h]=(0,o.useState)({className:l,id:a,style:c}),[v,y]=(0,o.useState)(null);(0,o.useImperativeHandle)(m,()=>v?.map??null,[v]);let O=(0,o.useCallback)(r=>{if(null!==r&&null===v){let l=new s.Map(r,g);null!=n&&null!=p?l.setView(n,p):null!=e&&l.fitBounds(e,t),null!=f&&l.whenReady(f),y(Object.freeze({__version:1,map:l}))}},[]);(0,o.useEffect)(()=>()=>{v?.map.remove()},[v]);let b=v?o.createElement(u,{value:v},r):i??null;return o.createElement("div",d({},h,{ref:O}),b)});function g(e){return(0,o.forwardRef)(function(t,n){let{instance:r,context:l}=e(t).current;return(0,o.useImperativeHandle)(n,()=>r),null==t.children?null:o.createElement(u,{value:l},t.children)})}function m(e,t,n){return Object.freeze({instance:e,context:t,container:n})}function h(e,t){return null==t?function(t,n){let r=(0,o.useRef)();return r.current||(r.current=e(t,n)),r}:function(n,r){let l=(0,o.useRef)();l.current||(l.current=e(n,r));let a=(0,o.useRef)(n),{instance:i}=l.current;return(0,o.useEffect)(function(){a.current!==n&&(t(i,n,a.current),a.current=n)},[i,n,r]),l}}function v(e,t){let n=(0,o.useRef)();(0,o.useEffect)(function(){return null!=t&&e.instance.on(t),n.current=t,function(){null!=n.current&&e.instance.off(n.current),n.current=null}},[e,t])}function y(e,t){let n=e.pane??t.pane;return n?{...e,pane:n}:e}function O(e,t){(0,o.useEffect)(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){t.layerContainer?.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function b(e){return function(t){let n=c(),r=e(y(t,n),n);return!function(e,t){let n=(0,o.useRef)(t);(0,o.useEffect)(function(){t!==n.current&&null!=e.attributionControl&&(null!=n.current&&e.attributionControl.removeAttribution(n.current),null!=t&&e.attributionControl.addAttribution(t)),n.current=t},[e,t])}(n.map,t.attribution),v(r.current,t.eventHandlers),O(r.current,n),r}}function x(e,t){var n;return g((n=h(e,t),function(e){let t=c(),r=n(y(e,t),t);return v(r.current,e.eventHandlers),O(r.current,t),function(e,t){let n=(0,o.useRef)();(0,o.useEffect)(function(){if(t.pathOptions!==n.current){let r=t.pathOptions??{};e.instance.setStyle(r),n.current=r}},[e,t])}(r.current,e),r}))}n(3935);let C=(r=b(h(function({url:e,...t},n){return m(new s.TileLayer(e,y(t,n)),n)},function(e,t,n){!function(e,t,n){let{opacity:r,zIndex:l}=t;null!=r&&r!==n.opacity&&e.setOpacity(r),null!=l&&l!==n.zIndex&&e.setZIndex(l)}(e,t,n);let{url:r}=t;null!=r&&r!==n.url&&e.setUrl(r)})),(0,o.forwardRef)(function(e,t){let{instance:n}=r(e).current;return(0,o.useImperativeHandle)(t,()=>n),null})),w=x(function({positions:e,...t},n){let r=new s.Polyline(e,t);return m(r,a(n,{overlayContainer:r}))},function(e,t,n){t.positions!==n.positions&&e.setLatLngs(t.positions)}),E=x(function({center:e,children:t,...n},r){let l=new s.Circle(e,n);return m(l,a(r,{overlayContainer:l}))},function(e,t,n){t.center!==n.center&&e.setLatLng(t.center),null!=t.radius&&t.radius!==n.radius&&e.setRadius(t.radius)}),j=g(b(h(function({position:e,...t},n){let r=new s.Marker(e,t);return m(r,a(n,{overlayContainer:r}))},function(e,t,n){t.position!==n.position&&e.setLatLng(t.position),null!=t.icon&&t.icon!==n.icon&&e.setIcon(t.icon),null!=t.zIndexOffset&&t.zIndexOffset!==n.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),null!=t.opacity&&t.opacity!==n.opacity&&e.setOpacity(t.opacity),null!=e.dragging&&t.draggable!==n.draggable&&(!0===t.draggable?e.dragging.enable():e.dragging.disable())})));var z=n(1163);let S=e=>f().icon({iconUrl:"".concat(e,"/leaflet/marker-icon.png"),iconRetinaUrl:"".concat(e,"/leaflet/marker-icon-2x.png"),shadowUrl:"".concat(e,"/leaflet/marker-shadow.png"),iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),R={N:[.001,0],NE:[7e-4,7e-4],E:[0,.001],SE:[-.0007,7e-4],S:[-.001,0],SO:[-.0007,-.0007],O:[0,-.001],NO:[7e-4,-.0007]};var L=e=>{let{coords:t,condiciones:n,fase:r}=e,a=(0,z.useRouter)().basePath,i=S(a),[u,s]=(0,o.useState)(t),[f,d]=(0,o.useState)(350),[g,m]=(0,o.useState)(null),[h,v]=(0,o.useState)([]);(0,o.useEffect)(()=>{fetch("".concat(a).concat("/geojson/andalucia-v2.geojson")).then(e=>{if(!e.ok)throw Error("GeoJSON fetch failed: ".concat(e.statusText));return e.json()}).then(e=>m(e)).catch(e=>{console.error("Error loading GeoJSON:",e)})},[a]),(0,o.useEffect)(()=>{if(!n)return;let[e,t]=R[n.viento.direccion]||[0,0];s(r=>{let l={lat:r.lat+e*n.viento.fuerza*.1,lng:r.lng+t*n.viento.fuerza*.1};return v(e=>[...e,l]),l}),d(e=>e+50)},[r,n]),(0,o.useEffect)(()=>{let e;let t=0,n=h.length>0?h[h.length-1]:u;if(u.lat!==n.lat||u.lng!==n.lng){let r=()=>{let l=++t/20;s({lat:u.lat+(n.lat-u.lat)*l,lng:u.lng+(n.lng-u.lng)*l}),t<20&&(e=requestAnimationFrame(r))};r()}return()=>cancelAnimationFrame(e)},[h,u]);let y=g?function(e){let t=e.features.find(e=>{var t,n;return"LineString"===e.geometry.type&&((null===(t=e.properties)||void 0===t?void 0:t.layer)==="costa"||(null===(n=e.properties)||void 0===n?void 0:n.layer)==="coastline")});return t?t.geometry.coordinates.map(e=>[e[0],e[1]]):null}(g):null;return(0,l.jsx)("div",{className:"card card-max card-centered map-card-outer mb-2",children:(0,l.jsxs)(p,{center:[u.lat,u.lng],zoom:14,className:"sim-map-container",scrollWheelZoom:!1,dragging:!1,doubleClickZoom:!1,zoomControl:!1,attributionControl:!1,children:[(0,l.jsx)(function(e){let{center:t,radio:n}=e,r=c().map;return(0,o.useEffect)(()=>{let e=12.5;n>1200&&(e=11.5),n>2500&&(e=10.5),n>4e3&&(e=9.5),n>6e3&&(e=8.5),n>8e3&&(e=7.5),n>1e4&&(e=6.5),n>12e3&&(e=5.5),r.setView(t,e,{animate:!0})},[t,n,r]),null},{center:[u.lat,u.lng],radio:f}),(0,l.jsx)(C,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),y&&y.length>1&&(0,l.jsx)(w,{positions:y.map(e=>{let[t,n]=e;return[n,t]}),pathOptions:{color:"#e53935",weight:2,opacity:.5}}),(0,l.jsx)(E,{center:[u.lat,u.lng],radius:1.7*f,pathOptions:{color:void 0,fillColor:"#0277bd",fillOpacity:.07},className:"mancha-glow"}),(0,l.jsx)(E,{center:[u.lat,u.lng],radius:1.4*f,pathOptions:{color:void 0,fillColor:"#0277bd",fillOpacity:.13}}),(0,l.jsx)(E,{center:[u.lat,u.lng],radius:1.15*f,pathOptions:{color:void 0,fillColor:"#0277bd",fillOpacity:.18}}),(0,l.jsx)(E,{center:[u.lat,u.lng],radius:f,pathOptions:{color:"#0277bd",fillColor:"#0277bd",fillOpacity:.35}}),h.slice(-5,-1).map((e,t)=>(0,l.jsx)(E,{center:[e.lat,e.lng],radius:.7*f,pathOptions:{color:void 0,fillColor:"#81d4fa",fillOpacity:.1}},t)),i&&(0,l.jsx)(j,{position:t,icon:i})]})})}}}]);